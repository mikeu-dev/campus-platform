generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/client"
}

datasource db {
  provider = "postgresql"
}

model pmb_applicants {
  id                     String          @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id              String          @db.Uuid
  period_id              String?         @db.Uuid
  registration_number    String          @unique @db.VarChar(20)
  full_name              String          @db.VarChar(255)
  email                  String          @db.VarChar(255)
  phone_number           String?         @db.VarChar(20)
  identity_number        String?         @db.VarChar(50)
  address                String?
  birth_place            String?         @db.VarChar(100)
  birth_date             DateTime?       @db.Date
  gender                 String?         @db.VarChar(10)
  religion               String?         @db.VarChar(20)
  previous_school        String?         @db.VarChar(255)
  first_choice_prodi_id  String?         @db.Uuid
  second_choice_prodi_id String?         @db.Uuid
  status                 String?         @default("REGISTERED") @db.VarChar(20)
  selection_score        Decimal?        @db.Decimal(10, 2)
  created_at             DateTime?       @default(now()) @db.Timestamptz(6)
  updated_at             DateTime?       @default(now()) @db.Timestamptz(6)
  pmb_periods            pmb_periods?    @relation(fields: [period_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  pmb_documents          pmb_documents[]

  @@index([registration_number], map: "idx_pmb_applicants_reg_num")
  @@index([status], map: "idx_pmb_applicants_status")
  @@index([tenant_id], map: "idx_pmb_applicants_tenant")
}

model pmb_documents {
  id             String          @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  applicant_id   String?         @db.Uuid
  document_type  String          @db.VarChar(50)
  file_url       String
  status         String?         @default("PENDING") @db.VarChar(20)
  notes          String?
  created_at     DateTime?       @default(now()) @db.Timestamptz(6)
  updated_at     DateTime?       @default(now()) @db.Timestamptz(6)
  pmb_applicants pmb_applicants? @relation(fields: [applicant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model pmb_periods {
  id             String           @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id      String           @db.Uuid
  name           String           @db.VarChar(100)
  start_date     DateTime         @db.Date
  end_date       DateTime         @db.Date
  is_active      Boolean?         @default(true)
  description    String?
  created_at     DateTime?        @default(now()) @db.Timestamptz(6)
  updated_at     DateTime?        @default(now()) @db.Timestamptz(6)
  pmb_applicants pmb_applicants[]
}

model pmb_prodis {
  id         String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id  String    @db.Uuid
  name       String    @db.VarChar(255)
  faculty    String?   @db.VarChar(255)
  is_active  Boolean?  @default(true)
  created_at DateTime? @default(now()) @db.Timestamptz(6)
}
